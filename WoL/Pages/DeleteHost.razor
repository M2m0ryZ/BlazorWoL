@page "/DeleteHost/{Id:int}"

@using WoL.Data
@using WoL.Models
@using WoL.Services
@using WoL.Extensions
@inject IHostService HostService
@inject IAddressLookupService AddressService
@inject NavigationManager NavigationManager

<h3>Add Host</h3>

<hr />

<p>
    Are you sure you want to delete this?
</p>

@if (model != null)
{
    <div class="col-lg-8">
        <dl class="row">
            <dt class="col-sm-2">
                Title
            </dt>
            <dd class="col-sm-10">
                @model.Caption
            </dd>
            <dt class="col-sm-2">
                Mac Address
            </dt>
            <dd class="col-sm-10">
                @model.GetMacString()
            </dd>
            <dt class="col-sm-2">
                Hostname
            </dt>
            <dd class="col-sm-10">
                @model.Hostname
            </dd>
        </dl>

        <div>

                @if (Deleting)
                {
                    <button class="btn btn-danger" type="button" disabled>
                        <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
                        Deleting...
                    </button>
                }
                else
                {
                    <button class="btn btn-danger" @onclick="Delete">Delete</button>
                } |
                <a href="">
                Back to List
            </a>
        </div>
    </div>
}

@code {
    [Parameter]
    public int Id { get; set; }

    Host model;
    bool Deleting = false;

    protected override async Task OnParametersSetAsync()
    {
        model = await HostService.Find(Id);
    }

    private async Task Delete()
    {
        Deleting = true;
        await HostService.Delete(Id);
        NavigationManager.NavigateTo("/");
    }
}
